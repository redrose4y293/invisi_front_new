import{j as e,r}from"./index-Damo5oZI.js";import{S as w}from"./StatusBadge-871Fm8_w.js";import{a as u}from"./api-DhFjHDpY.js";function p({title:x,value:n,trend:c="flat",note:o}){const i=c==="up"?"#10B981":c==="down"?"#EF4444":"#C5C6C7";return e.jsxs("div",{style:{background:"#0E1621",border:"1px solid #223",borderRadius:12,padding:16,display:"grid",gap:6},children:[e.jsx("div",{style:{color:"#C5C6C7",fontSize:12},children:x}),e.jsx("div",{style:{fontSize:28,fontWeight:700},children:n}),o&&e.jsx("div",{style:{color:i,fontSize:12},children:o})]})}function C(){const[x,n]=r.useState(!0),[c,o]=r.useState(""),[i,j]=r.useState({totalLeads:0,activeDealers:0,proto30d:0,downloads30d:0}),[g,m]=r.useState([]),[y,v]=r.useState([]),[k,R]=r.useState("30d"),[a,h]=r.useState("month"),b=async()=>{try{o(""),n(!0);try{const d=await u.get("/admin/stats");j({totalLeads:Number(d.totalLeads||0),activeDealers:Number(d.activeDealers||0),proto30d:Number(d.proto30d||0),downloads30d:Number(d.downloads30d||0)})}catch{}try{const d=await u.get("/dealers"),l=((d==null?void 0:d.items)||d||[]).slice(0,5).map(s=>({org:s.org||s.name||s.title||"Dealer",region:s.region||s.location||"",users:s.users||s.userCount||0}));m(l)}catch{}try{const d=await u.get("/leads"),l=((d==null?void 0:d.items)||d||[]).slice(0,10).map(s=>({name:s.name||s.contact||"—",company:s.company,status:s.status||"New",created:s.createdAt||s.created||""}));v(l)}catch{}}catch(d){o(d.message||"Failed")}finally{n(!1)}};r.useEffect(()=>{b()},[]),r.useMemo(()=>{const d=new Date,t=new Date(d);return a==="today"?t.setHours(0,0,0,0):a==="week"?(t.setDate(d.getDate()-7),t.setHours(0,0,0,0)):(t.setDate(d.getDate()-30),t.setHours(0,0,0,0)),t},[a]);const f=r.useMemo(()=>[...y].filter(t=>t.created).sort((t,l)=>new Date(l.created).getTime()-new Date(t.created).getTime()).slice(0,3),[y]);return e.jsxs("div",{style:{display:"grid",gap:16},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:8},children:[e.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:10},children:[e.jsx("h1",{style:{margin:0},children:"Dashboard"}),e.jsx("span",{style:{color:"#9aa4af",fontSize:12},children:"Overview"})]}),e.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[e.jsx("button",{onClick:()=>h("today"),style:{padding:"8px 10px",border:"1px solid #233140",background:a==="today"?"var(--accent)":"#0B1117",color:a==="today"?"#fff":"#E6E6E6",borderRadius:8},children:"Today"}),e.jsx("button",{onClick:()=>h("week"),style:{padding:"8px 10px",border:"1px solid #233140",background:a==="week"?"var(--accent)":"#0B1117",color:a==="week"?"#fff":"#E6E6E6",borderRadius:8},children:"This Week"}),e.jsx("button",{onClick:()=>h("month"),style:{padding:"8px 10px",border:"1px solid #233140",background:a==="month"?"var(--accent)":"#0B1117",color:a==="month"?"#fff":"#E6E6E6",borderRadius:8},children:"This Month"})]})]}),e.jsx("div",{style:{display:"grid",gap:12,gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))"},children:x?Array.from({length:4}).map((d,t)=>e.jsx("div",{style:{background:"#0E1621",border:"1px solid #223",borderRadius:12,padding:20,height:98,opacity:.7}},t)):c?e.jsxs("div",{style:{gridColumn:"1/-1",background:"#2a1515",border:"1px solid #442",borderRadius:12,padding:16},children:[e.jsx("div",{style:{marginBottom:8},children:"Error loading KPIs."}),e.jsx("button",{onClick:b,style:{padding:"8px 10px",border:"1px solid #334",borderRadius:8},children:"Retry"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{background:"linear-gradient(180deg, #0f1a26, #0d151f)",border:"1px solid #213042",borderRadius:14,padding:16,boxShadow:"0 6px 18px rgba(0,0,0,0.25)"},children:e.jsx(p,{title:"Total Leads",value:i.totalLeads,trend:"up"})}),e.jsx("div",{style:{background:"linear-gradient(180deg, #0f1a26, #0d151f)",border:"1px solid #213042",borderRadius:14,padding:16,boxShadow:"0 6px 18px rgba(0,0,0,0.25)"},children:e.jsx(p,{title:"Active Dealers",value:i.activeDealers,trend:"flat"})}),e.jsx("div",{style:{background:"linear-gradient(180deg, #0f1a26, #0d151f)",border:"1px solid #213042",borderRadius:14,padding:16,boxShadow:"0 6px 18px rgba(0,0,0,0.25)"},children:e.jsx(p,{title:"Prototype Requests (30d)",value:i.proto30d,trend:"up"})}),e.jsx("div",{style:{background:"linear-gradient(180deg, #0f1a26, #0d151f)",border:"1px solid #213042",borderRadius:14,padding:16,boxShadow:"0 6px 18px rgba(0,0,0,0.25)"},children:e.jsx(p,{title:"File Downloads (30d)",value:i.downloads30d,trend:"up"})})]})}),e.jsxs("div",{style:{background:"#0E1621",border:"1px solid #223",borderRadius:12,padding:16,display:"grid",gap:10},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("strong",{children:"Active Dealers"}),e.jsx("a",{href:"/app/dealers",style:{padding:"6px 10px",border:"1px solid #233140",borderRadius:8,background:"#0B1117",color:"var(--accent)",textDecoration:"none"},children:"View all"})]}),e.jsxs("div",{style:{display:"grid",gap:8},children:[(g.length?g:[]).map(d=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",border:"1px solid #1c2a39",borderRadius:10,padding:"10px 12px",flexWrap:"wrap",gap:8},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,minWidth:0},children:[e.jsx("div",{style:{width:28,height:28,borderRadius:8,background:"#1A73E8",color:"#fff",display:"grid",placeItems:"center"},children:d.org[0]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600},children:d.org}),e.jsxs("div",{style:{fontSize:12,color:"#9aa4af"},children:[d.region||"—"," • ",d.users||0," users"]})]})]}),e.jsx("a",{href:"/app/dealers",style:{fontSize:12,color:"var(--accent)"},children:"Open"})]},d.org+String(d.region))),!g.length&&e.jsx("div",{style:{color:"#9aa4af"},children:"No active dealers found."})]})]}),e.jsxs("div",{style:{background:"#0E1621",border:"1px solid #223",borderRadius:12,padding:16,display:"grid",gap:8},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("strong",{children:"Recent Deals"}),e.jsx("a",{href:"/app/leads",style:{padding:"6px 10px",border:"1px solid #233140",borderRadius:8,background:"#0B1117",color:"var(--accent)",textDecoration:"none"},children:"View all"})]}),e.jsx("div",{style:{border:"1px solid #223",borderRadius:10,overflow:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",minWidth:520},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{textAlign:"left",padding:10,borderBottom:"1px solid #223"},children:"Company"}),e.jsx("th",{style:{textAlign:"left",padding:10,borderBottom:"1px solid #223"},children:"Contact"}),e.jsx("th",{style:{textAlign:"left",padding:10,borderBottom:"1px solid #223"},children:"Stage"}),e.jsx("th",{style:{textAlign:"left",padding:10,borderBottom:"1px solid #223"},children:"Updated"})]})}),e.jsxs("tbody",{children:[f.map(d=>e.jsxs("tr",{children:[e.jsx("td",{style:{padding:10,borderBottom:"1px solid #16202c"},children:d.company||"—"}),e.jsx("td",{style:{padding:10,borderBottom:"1px solid #16202c"},children:d.name}),e.jsx("td",{style:{padding:10,borderBottom:"1px solid #16202c"},children:e.jsx(w,{status:d.status})}),e.jsx("td",{style:{padding:10,borderBottom:"1px solid #16202c"},children:d.created})]},d.name+d.created)),!f.length&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,style:{padding:12,textAlign:"center",color:"#9aa4af"},children:"No recent deals to show."})})]})]})})]}),e.jsxs("div",{style:{background:"#0E1621",border:"1px solid #223",borderRadius:12,padding:16,display:"grid",gap:8},children:[e.jsx("strong",{children:"Quick Actions"}),e.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[e.jsx("a",{href:"/app/content",children:"Add Product"}),e.jsx("a",{href:"/app/files",children:"Add File"}),e.jsx("a",{href:"/app/dealers",children:"Invite Dealer"}),e.jsx("a",{href:"/app/leads",children:"Export Leads"})]})]})]})}export{C as default};
